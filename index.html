<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The World Through Time â€” Population by Country, 1950â€“2100</title>
<meta name="description" content="Watch the world's population shift from 1950 to 2100. An interactive, animated visualization of every country's rise and fall.">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0a0a1a;
  color: #e2e8f0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  overflow-x: hidden;
  min-height: 100vh;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 20px 16px;
}

header {
  text-align: center;
  padding: 40px 0 20px;
}

header h1 {
  font-size: clamp(1.5rem, 4vw, 2.5rem);
  font-weight: 800;
  background: linear-gradient(135deg, #60a5fa, #a78bfa, #f472b6);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 8px;
}

header p {
  color: #64748b;
  font-size: 0.95rem;
}

/* Year display */
.year-display {
  text-align: center;
  margin: 20px 0 8px;
  user-select: none;
}

.year-number {
  font-size: clamp(3rem, 10vw, 6rem);
  font-weight: 900;
  font-variant-numeric: tabular-nums;
  letter-spacing: -2px;
  transition: color 0.3s;
}

.year-era {
  font-size: 0.85rem;
  color: #64748b;
  margin-top: -4px;
}

.world-total {
  text-align: center;
  font-size: 1.1rem;
  color: #94a3b8;
  margin-bottom: 20px;
  font-variant-numeric: tabular-nums;
}

.world-total strong {
  color: #e2e8f0;
  font-size: 1.3rem;
}

/* Controls */
.controls {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 24px;
}

.play-btn {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  border: 2px solid #334155;
  background: rgba(255,255,255,0.05);
  color: #e2e8f0;
  font-size: 18px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
  flex-shrink: 0;
}

.play-btn:hover { border-color: #60a5fa; background: rgba(96,165,250,0.1); }

.slider-wrap {
  flex: 1;
  position: relative;
}

input[type=range] {
  width: 100%;
  -webkit-appearance: none;
  appearance: none;
  height: 6px;
  background: #1e293b;
  border-radius: 3px;
  outline: none;
  cursor: pointer;
}

input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #60a5fa;
  border: 2px solid #0a0a1a;
  cursor: grab;
}

input[type=range]::-moz-range-thumb {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #60a5fa;
  border: 2px solid #0a0a1a;
  cursor: grab;
}

.speed-btn {
  padding: 4px 10px;
  border-radius: 6px;
  border: 1px solid #334155;
  background: transparent;
  color: #94a3b8;
  font-size: 0.75rem;
  cursor: pointer;
  flex-shrink: 0;
}

.speed-btn.active { border-color: #60a5fa; color: #60a5fa; }

/* Era markers */
.era-markers {
  display: flex;
  justify-content: space-between;
  padding: 0 2px;
  margin-top: 4px;
}

.era-markers span {
  font-size: 0.65rem;
  color: #475569;
}

/* Bar chart */
.chart {
  position: relative;
}

.bar-row {
  display: flex;
  align-items: center;
  margin-bottom: 3px;
  height: 28px;
  cursor: default;
}

.bar-label {
  width: 110px;
  text-align: right;
  padding-right: 10px;
  font-size: 0.8rem;
  color: #94a3b8;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex-shrink: 0;
  font-variant-numeric: tabular-nums;
}

.bar-label .rank {
  color: #475569;
  font-size: 0.7rem;
  margin-right: 4px;
}

.bar-track {
  flex: 1;
  height: 22px;
  position: relative;
  border-radius: 4px;
  overflow: visible;
}

.bar-fill {
  height: 100%;
  border-radius: 4px;
  transition: width 0.15s ease-out, background-color 0.5s;
  position: relative;
  min-width: 2px;
}

.bar-value {
  position: absolute;
  right: -4px;
  top: 50%;
  transform: translate(100%, -50%);
  font-size: 0.7rem;
  color: #64748b;
  padding-left: 6px;
  white-space: nowrap;
  font-variant-numeric: tabular-nums;
}

.bar-row:hover .bar-label { color: #e2e8f0; }
.bar-row:hover .bar-value { color: #94a3b8; }

/* Insight panel */
.insight {
  margin-top: 32px;
  padding: 16px 20px;
  border-radius: 12px;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.06);
  font-size: 0.85rem;
  color: #94a3b8;
  line-height: 1.6;
  min-height: 60px;
}

.insight strong { color: #e2e8f0; }
.insight .highlight { color: #60a5fa; }

/* Footer */
footer {
  text-align: center;
  padding: 40px 0 20px;
  color: #334155;
  font-size: 0.75rem;
}

footer a { color: #475569; }

/* Projection line */
.projection-note {
  text-align: center;
  font-size: 0.7rem;
  color: #475569;
  margin-bottom: 12px;
  opacity: 0;
  transition: opacity 0.3s;
}

.projection-note.visible { opacity: 1; }

@media (max-width: 600px) {
  .bar-label { width: 80px; font-size: 0.7rem; }
  .bar-row { height: 24px; }
  .bar-fill { height: 18px; }
  .bar-track { height: 18px; }
  .bar-value { font-size: 0.6rem; }
  header { padding: 24px 0 12px; }
}
</style>
</head>
<body>

<div class="container">
  <header>
    <h1>The World Through Time</h1>
    <p>Population by country, 1950 â€“ 2100</p>
  </header>

  <div class="year-display">
    <div class="year-number" id="yearNum">1950</div>
    <div class="year-era" id="yearEra">Post-War Baby Boom</div>
  </div>

  <div class="world-total">
    World: <strong id="worldTotal">2.5 billion</strong>
  </div>

  <div class="controls">
    <button class="play-btn" id="playBtn" aria-label="Play">â–¶</button>
    <div class="slider-wrap">
      <input type="range" id="yearSlider" min="1950" max="2100" value="1950" step="1">
      <div class="era-markers">
        <span>1950</span><span>1975</span><span>2000</span><span>2025</span><span>2050</span><span>2075</span><span>2100</span>
      </div>
    </div>
    <button class="speed-btn active" id="speedBtn" data-speed="1">1Ã—</button>
  </div>

  <div class="projection-note" id="projNote">ğŸ“ Projections (UN Medium Variant)</div>

  <div class="chart" id="chart"></div>

  <div class="insight" id="insight"></div>

  <footer>
    Data: UN World Population Prospects 2024 (Medium Variant) Â· Built by <a href="https://wickedlysmart.com">WickedlySmart</a>
  </footer>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// POPULATION DATA â€” UN WPP 2024 Medium Variant
// Top 40 countries, every 5 years 1950-2100 (in millions)
// Interpolated to single years at runtime
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const DATA = {
  "China":          [554,594,660,729,818,927,981,1044,1135,1177,1212,1263,1296,1318,1341,1354,1412,1426,1410,1371,1313,1240,1157,1068,977,889,806,732,666,604,548],
  "India":          [376,409,450,499,555,623,700,789,873,942,1006,1057,1105,1155,1210,1266,1324,1380,1429,1461,1475,1471,1451,1416,1369,1313,1250,1183,1114,1044,976],
  "United States":  [158,172,187,200,210,220,232,243,256,272,287,295,306,318,329,335,339,345,350,355,358,360,361,361,359,357,354,350,345,340,336],
  "Indonesia":      [70,82,97,115,135,149,166,180,191,201,214,229,242,253,264,272,278,282,284,285,284,281,277,272,265,257,248,239,229,219,210],
  "Pakistan":       [37,43,50,58,66,73,83,96,111,127,144,159,174,190,207,221,234,245,255,264,271,277,280,282,282,280,276,270,263,256,248],
  "Brazil":         [54,62,72,83,96,108,121,137,152,166,176,185,193,200,206,211,214,216,215,213,210,205,199,192,184,176,167,159,150,142,134],
  "Nigeria":        [38,42,48,56,64,72,81,90,100,115,131,148,169,192,219,248,280,313,350,389,429,467,502,534,562,586,605,620,631,640,646],
  "Bangladesh":     [38,43,50,59,67,72,80,89,99,111,123,133,142,150,157,163,168,172,174,174,172,169,165,160,154,147,140,132,125,117,110],
  "Russia":         [103,111,120,129,134,137,139,143,148,147,146,144,142,143,144,145,146,144,141,138,135,132,128,124,120,116,112,108,104,100,97],
  "Mexico":         [28,34,41,50,60,68,76,83,89,97,104,109,115,120,126,130,133,134,135,135,134,132,129,125,121,116,111,106,101,96,91],
  "Japan":          [84,90,94,99,105,112,117,122,124,126,127,127,128,128,127,126,124,123,119,115,110,104,98,93,87,82,77,73,69,65,62],
  "Ethiopia":       [18,21,24,28,32,35,39,43,48,56,66,77,88,99,113,126,140,155,170,186,201,215,228,239,248,255,260,264,266,266,265],
  "Philippines":    [18,22,27,33,39,44,49,55,62,69,77,84,90,96,101,106,111,115,118,120,121,122,121,120,118,116,113,110,106,103,99],
  "Egypt":          [21,24,27,31,35,39,44,50,57,63,69,75,82,88,96,103,109,114,120,125,130,134,137,140,142,143,143,142,141,140,138],
  "Vietnam":        [25,28,33,40,47,49,54,60,66,75,80,84,88,91,93,95,97,98,99,99,98,96,94,91,88,85,81,77,73,70,66],
  "DR Congo":       [12,14,16,19,22,24,27,30,34,40,47,55,63,72,84,97,112,128,147,168,190,212,234,254,273,290,305,317,327,335,341],
  "Germany":        [70,72,73,75,78,78,78,77,79,82,82,82,82,82,81,80,79,84,83,82,80,79,77,75,73,71,69,67,65,63,61],
  "Turkey":         [21,24,28,33,38,42,46,51,56,62,67,71,74,77,80,82,84,86,87,88,88,87,86,85,83,81,79,76,74,71,69],
  "Iran":           [17,19,22,26,31,34,39,47,55,62,66,69,73,77,80,83,86,88,89,90,89,88,86,83,80,77,73,70,66,63,59],
  "Thailand":       [20,24,28,34,39,44,48,52,56,60,63,66,67,68,69,70,70,70,69,67,66,64,61,59,56,53,51,48,45,43,40],
  "United Kingdom": [51,51,52,54,56,56,56,57,58,59,59,60,61,63,65,66,67,68,69,70,71,72,72,73,73,73,72,72,71,71,70],
  "France":         [42,44,46,49,52,53,55,56,57,59,60,61,62,64,65,66,67,68,68,68,68,68,68,67,67,66,65,65,64,63,62],
  "Italy":          [47,48,50,52,54,55,57,57,57,57,57,57,58,59,59,60,60,59,58,57,55,53,52,50,48,46,45,43,42,40,39],
  "South Africa":   [14,16,18,21,24,27,30,33,36,40,45,47,49,52,54,57,59,62,64,65,66,66,66,66,65,64,62,61,59,57,55],
  "Tanzania":       [8,9,10,12,15,17,20,23,26,30,35,40,45,51,58,65,73,82,92,102,113,123,133,143,152,160,166,172,176,179,181],
  "South Korea":    [20,22,26,30,33,36,39,42,44,46,47,48,49,50,51,52,52,52,51,50,48,46,44,42,40,38,36,34,32,30,29],
  "Colombia":       [12,15,18,21,24,27,30,33,36,39,42,44,46,47,49,50,51,52,52,51,51,50,49,47,46,44,42,40,38,36,34],
  "Kenya":          [6,7,9,11,14,16,18,21,25,29,33,37,42,46,51,55,60,64,69,73,77,80,83,85,87,88,88,88,88,87,86],
  "Argentina":      [17,19,21,23,26,27,29,31,33,35,37,38,40,42,43,44,45,46,47,48,48,49,49,49,49,48,48,47,46,45,44],
  "Uganda":         [5,6,7,8,10,11,13,15,17,21,25,28,32,37,42,47,52,58,66,74,82,90,98,106,113,119,124,128,132,134,136],
  "Algeria":        [9,10,11,13,16,18,20,23,26,29,31,33,35,38,40,42,44,45,46,47,48,48,48,48,47,47,46,45,44,43,42],
  "Iraq":           [5,6,7,9,11,12,14,16,18,22,26,29,32,35,39,41,43,45,48,51,53,55,57,58,59,60,60,60,60,59,58],
  "Poland":         [25,28,30,31,33,34,36,37,38,39,39,38,38,38,38,38,38,38,37,36,35,34,33,32,31,30,28,27,26,25,24],
  "Canada":         [14,16,18,20,22,24,25,26,28,30,31,32,33,35,36,37,38,39,40,41,42,43,43,44,44,44,43,43,43,42,42],
  "Saudi Arabia":   [3,4,5,6,7,9,10,14,16,20,23,25,28,30,33,35,37,38,39,40,41,41,41,41,40,40,39,38,37,36,35],
  "Angola":         [4,5,5,6,7,7,8,9,10,12,14,17,20,24,28,32,37,42,47,52,57,63,68,73,77,81,84,86,88,89,90],
  "Mozambique":     [6,7,8,9,10,11,12,13,14,16,18,20,23,25,28,31,33,36,39,42,46,49,52,55,57,59,61,62,63,64,64],
  "Australia":      [8,9,11,12,14,14,15,16,17,19,20,20,21,22,23,24,26,27,28,29,30,31,31,32,32,33,33,33,33,33,33],
  "Ghana":          [5,6,7,8,10,11,12,14,16,18,20,22,25,27,30,32,34,36,38,40,42,44,45,47,48,48,49,49,49,49,48],
  "Nepal":          [8,9,10,11,13,14,15,17,19,21,24,26,27,28,29,29,30,30,30,31,31,31,30,30,29,28,27,27,26,25,24]
};

// Region colors
const REGION_COLORS = {
  "China": "#ef4444", "India": "#f97316", "United States": "#3b82f6",
  "Indonesia": "#14b8a6", "Pakistan": "#8b5cf6", "Brazil": "#22c55e",
  "Nigeria": "#eab308", "Bangladesh": "#06b6d4", "Russia": "#6366f1",
  "Mexico": "#ec4899", "Japan": "#f43f5e", "Ethiopia": "#a3e635",
  "Philippines": "#2dd4bf", "Egypt": "#fbbf24", "Vietnam": "#34d399",
  "DR Congo": "#facc15", "Germany": "#a78bfa", "Turkey": "#fb923c",
  "Iran": "#c084fc", "Thailand": "#4ade80", "United Kingdom": "#60a5fa",
  "France": "#818cf8", "Italy": "#f472b6", "South Africa": "#fcd34d",
  "Tanzania": "#86efac", "South Korea": "#f87171", "Colombia": "#a3e635",
  "Kenya": "#4ade80", "Argentina": "#67e8f9", "Uganda": "#bef264",
  "Algeria": "#fdba74", "Iraq": "#d8b4fe", "Poland": "#93c5fd",
  "Canada": "#f9a8d4", "Saudi Arabia": "#fde047", "Angola": "#fca5a5",
  "Mozambique": "#86efac", "Australia": "#7dd3fc", "Ghana": "#fde68a",
  "Nepal": "#c4b5fd"
};

// Years: 1950, 1955, 1960, ... 2100 â†’ 31 data points
const DATA_YEARS = [];
for (let y = 1950; y <= 2100; y += 5) DATA_YEARS.push(y);

// Interpolate to get value for any year
function getPopulation(country, year) {
  const d = DATA[country];
  if (!d) return 0;
  if (year <= 1950) return d[0];
  if (year >= 2100) return d[d.length - 1];
  const idx = (year - 1950) / 5;
  const lo = Math.floor(idx);
  const hi = Math.min(lo + 1, d.length - 1);
  const t = idx - lo;
  return d[lo] + (d[hi] - d[lo]) * t;
}

function formatPop(millions) {
  if (millions >= 1000) return (millions / 1000).toFixed(2) + 'B';
  return Math.round(millions) + 'M';
}

function formatBillions(millions) {
  return (millions / 1000).toFixed(1) + ' billion';
}

// Era descriptions
function getEra(year) {
  if (year < 1960) return "Post-War Baby Boom";
  if (year < 1970) return "The Population Explosion Begins";
  if (year < 1980) return "Green Revolution Feeds Billions";
  if (year < 1990) return "Asia's Rapid Growth";
  if (year < 2000) return "End of the Cold War Era";
  if (year < 2010) return "The Age of Globalization";
  if (year < 2020) return "The Digital Billion";
  if (year < 2030) return "India Overtakes China";
  if (year < 2040) return "Africa's Rise Begins";
  if (year < 2055) return "Peak Humanity Approaches";
  if (year < 2070) return "The Great Decline";
  if (year < 2090) return "Africa Becomes the Center";
  return "A Smaller, Older World";
}

// Dynamic insights
function getInsight(year) {
  const china = getPopulation("China", year);
  const india = getPopulation("India", year);
  const nigeria = getPopulation("Nigeria", year);
  const us = getPopulation("United States", year);
  const japan = getPopulation("Japan", year);
  const total = Object.keys(DATA).reduce((s, c) => s + getPopulation(c, year), 0);

  if (year === 1950) return "The world has just <strong>2.5 billion</strong> people. China and India together are already 37% of humanity. Europe's colonial empires are collapsing. The modern world is about to be born.";
  if (year >= 1959 && year <= 1961) return `<span class="highlight">China's Great Famine</span> (1959â€“61) kills 15â€“55 million. China's growth briefly stalls at <strong>${formatPop(china)}</strong> while India at <strong>${formatPop(india)}</strong> closes the gap.`;
  if (year >= 1978 && year <= 1980) return `<span class="highlight">China's One-Child Policy</span> begins (1979). China at <strong>${formatPop(china)}</strong> will bend its population curve for the next 40 years â€” with consequences that won't be fully felt until the 2020s.`;
  if (year >= 2022 && year <= 2024) return `<span class="highlight">India surpasses China</span> for the first time in recorded history. India: <strong>${formatPop(india)}</strong>. China: <strong>${formatPop(china)}</strong>. A milestone thousands of years in the making.`;
  if (year >= 2054 && year <= 2056) return `<span class="highlight">Peak humanity.</span> The world reaches ~<strong>${formatBillions(total)}</strong> people. From here, global population begins to decline for the first time since the Black Death.`;
  if (year >= 2058 && year <= 2060) return `Nigeria at <strong>${formatPop(nigeria)}</strong> is now the <strong>3rd most populous country</strong> on Earth, having passed the United States. Africa is the only continent still growing.`;
  if (year >= 2099 && year <= 2100) return `The world ends the century with <strong>${formatBillions(total)}</strong> people. China has <strong>halved</strong> from its peak. Nigeria and DR Congo are among the world's largest nations. Japan has lost <strong>half</strong> its population.`;
  
  if (year >= 2086 && year <= 2088) return `Japan at <strong>${formatPop(japan)}</strong> has lost nearly half its peak population. The economic and social implications â€” pensions, healthcare, empty cities â€” are the defining challenge of the late 21st century.`;
  if (year >= 2070 && year <= 2072) return `<span class="highlight">Africa's century.</span> Nigeria (<strong>${formatPop(nigeria)}</strong>), DR Congo, Ethiopia, and Tanzania are all in the global top 10. The continent holds over <strong>a third</strong> of humanity.`;
  if (year >= 2040 && year <= 2042) return `China's population is in <strong>freefall</strong> â€” down to <strong>${formatPop(china)}</strong> and falling fast. The one-child policy's demographic debt comes due: not enough workers, too many retirees.`;
  
  // Generic insights
  if (year < 2024) {
    return `World population: <strong>${formatBillions(total)}</strong>. China: <strong>${formatPop(china)}</strong>. India: <strong>${formatPop(india)}</strong>. ${china > india ? 'China leads India by ' + formatPop(china - india) + '.' : 'India leads China by ' + formatPop(india - china) + '.'}`;
  }
  return `World population: <strong>${formatBillions(total)}</strong>. The top 3: <strong>India</strong> (${formatPop(india)}), <strong>China</strong> (${formatPop(china)}), <strong>${nigeria > us ? 'Nigeria' : 'USA'}</strong> (${formatPop(Math.max(nigeria, us))}).`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDERING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const TOP_N = 20;
const chart = document.getElementById('chart');
const yearNum = document.getElementById('yearNum');
const yearEra = document.getElementById('yearEra');
const worldTotal = document.getElementById('worldTotal');
const slider = document.getElementById('yearSlider');
const playBtn = document.getElementById('playBtn');
const speedBtn = document.getElementById('speedBtn');
const insight = document.getElementById('insight');
const projNote = document.getElementById('projNote');

let currentYear = 1950;
let playing = false;
let interval = null;
let speed = 1;

// Pre-create bar rows
const countries = Object.keys(DATA);
const rows = {};

function initChart() {
  chart.innerHTML = '';
  for (let i = 0; i < TOP_N; i++) {
    const row = document.createElement('div');
    row.className = 'bar-row';
    row.innerHTML = `
      <div class="bar-label"><span class="rank">${i + 1}</span> <span class="name"></span></div>
      <div class="bar-track"><div class="bar-fill"><span class="bar-value"></span></div></div>
    `;
    chart.appendChild(row);
    rows[i] = row;
  }
}

function render(year) {
  currentYear = year;
  
  // Get all populations and sort
  const pops = countries.map(c => ({ name: c, pop: getPopulation(c, year) }));
  pops.sort((a, b) => b.pop - a.pop);
  const top = pops.slice(0, TOP_N);
  const maxPop = top[0].pop;
  const total = pops.reduce((s, p) => s + p.pop, 0);
  
  // Year color: blue for past, purple for projections
  const isProjection = year > 2024;
  yearNum.textContent = Math.round(year);
  yearNum.style.color = isProjection ? '#a78bfa' : '#e2e8f0';
  yearEra.textContent = getEra(year);
  worldTotal.innerHTML = `World: <strong>${formatBillions(total)}</strong>`;
  projNote.classList.toggle('visible', isProjection);
  
  // Update bars
  for (let i = 0; i < TOP_N; i++) {
    const row = rows[i];
    const d = top[i];
    const pct = (d.pop / maxPop) * 100;
    const color = REGION_COLORS[d.name] || '#64748b';
    
    row.querySelector('.rank').textContent = (i + 1);
    row.querySelector('.name').textContent = d.name;
    
    const fill = row.querySelector('.bar-fill');
    fill.style.width = Math.max(pct, 0.5) + '%';
    fill.style.backgroundColor = color;
    
    row.querySelector('.bar-value').textContent = formatPop(d.pop);
  }
  
  // Insight
  insight.innerHTML = getInsight(Math.round(year));
  
  // Slider
  slider.value = year;
}

function play() {
  if (playing) {
    pause();
    return;
  }
  playing = true;
  playBtn.textContent = 'â¸';
  
  if (currentYear >= 2100) currentYear = 1950;
  
  const step = () => {
    currentYear += speed * 0.5;
    if (currentYear > 2100) {
      currentYear = 2100;
      pause();
    }
    render(currentYear);
  };
  
  interval = setInterval(step, 50);
}

function pause() {
  playing = false;
  playBtn.textContent = 'â–¶';
  if (interval) clearInterval(interval);
}

// Events
playBtn.addEventListener('click', play);

slider.addEventListener('input', () => {
  pause();
  render(parseInt(slider.value));
});

speedBtn.addEventListener('click', () => {
  const speeds = [1, 2, 4];
  const labels = ['1Ã—', '2Ã—', '4Ã—'];
  const idx = (speeds.indexOf(speed) + 1) % speeds.length;
  speed = speeds[idx];
  speedBtn.textContent = labels[idx];
});

// Keyboard
document.addEventListener('keydown', (e) => {
  if (e.code === 'Space') { e.preventDefault(); play(); }
  if (e.code === 'ArrowRight') { pause(); render(Math.min(currentYear + 1, 2100)); }
  if (e.code === 'ArrowLeft') { pause(); render(Math.max(currentYear - 1, 1950)); }
});

// Init
initChart();
render(1950);

// Auto-play after a brief pause
setTimeout(play, 1500);
</script>
</body>
</html>
